# Database Diagram - LLM Chat System

## ğŸ“Š Database Architecture Overview

à¸£à¸°à¸šà¸šà¹ƒà¸Šà¹‰ **PostgreSQL 15 + pgvector extension** à¸ªà¸³à¸«à¸£à¸±à¸šà¸ˆà¸±à¸”à¸à¸²à¸£à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸¥à¸°à¸à¸²à¸£à¸„à¹‰à¸™à¸«à¸²à¹à¸šà¸š Semantic Search à¸”à¹‰à¸§à¸¢ embeddings

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PostgreSQL Database                           â”‚
â”‚                  (Port: 5432)                                    â”‚
â”‚                  vit-llm-chat-database-1                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Database: llmchat_db                                           â”‚
â”‚  User: llmchat_user                                             â”‚
â”‚  Extensions: pgvector (vector similarity search)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“‹ Database Tables

### 1. ğŸ‘¤ users
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ**: à¸ˆà¸±à¸”à¸à¸²à¸£à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰ à¹à¸¥à¸° authentication

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: users                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id              â”‚  UUID        â”‚  PK         â”‚  User ID       â”‚
â”‚  email           â”‚  STRING      â”‚  UNIQUE     â”‚  Email address â”‚
â”‚  password_hash   â”‚  STRING      â”‚  NOT NULL   â”‚  Bcrypt hash   â”‚
â”‚  role            â”‚  STRING      â”‚  CHECK      â”‚  User role     â”‚
â”‚                  â”‚              â”‚             â”‚  (admin/staff  â”‚
â”‚                  â”‚              â”‚             â”‚  /sponsor/     â”‚
â”‚                  â”‚              â”‚             â”‚  member_pro/   â”‚
â”‚                  â”‚              â”‚             â”‚  member/guest)  â”‚
â”‚  first_name      â”‚  STRING      â”‚             â”‚  First name    â”‚
â”‚  last_name       â”‚  STRING      â”‚             â”‚  Last name     â”‚
â”‚  limit_per_minuteâ”‚  INTEGER     â”‚  DEF:60     â”‚  API rate limitâ”‚
â”‚  is_protected    â”‚  BOOLEAN     â”‚  DEF:false â”‚  Protected userâ”‚
â”‚  is_suspended    â”‚  BOOLEAN     â”‚  DEF:false â”‚  Suspended userâ”‚
â”‚  created_at      â”‚  TIMESTAMP   â”‚             â”‚  Created time  â”‚
â”‚  updated_at      â”‚  TIMESTAMP   â”‚             â”‚  Updated time  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- à¸ˆà¸±à¸”à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ authentication (JWT-based)
- à¸ˆà¸±à¸”à¸à¸²à¸£ role-based access control (RBAC)
- à¸à¸³à¸«à¸™à¸” rate limiting à¸•à¹ˆà¸­ user
- à¸›à¹‰à¸­à¸‡à¸à¸±à¸™à¸à¸²à¸£à¸¥à¸š user à¸ªà¸³à¸„à¸±à¸ (is_protected = true)

**Relationships**:
- One-to-One: `tokens` (refresh tokens)
- One-to-Many: `businesses`, `chat_sessions`, `subscriptions`, `transactions`

---

### 2. ğŸ”‘ tokens
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ**: à¸ˆà¸±à¸”à¹€à¸à¹‡à¸š refresh tokens à¸ªà¸³à¸«à¸£à¸±à¸š JWT authentication

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: tokens                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  user_id         â”‚  UUID        â”‚  PK, FK     â”‚  Reference     â”‚
â”‚                  â”‚              â”‚             â”‚  to users.id    â”‚
â”‚  refresh_token   â”‚  STRING      â”‚  NOT NULL   â”‚  JWT token     â”‚
â”‚  created_at      â”‚  TIMESTAMP   â”‚             â”‚  Created time  â”‚
â”‚  updated_at      â”‚  TIMESTAMP   â”‚             â”‚  Updated time  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- à¸ˆà¸±à¸”à¹€à¸à¹‡à¸š refresh tokens à¸ªà¸³à¸«à¸£à¸±à¸š token rotation
- à¹ƒà¸Šà¹‰à¸ªà¸³à¸«à¸£à¸±à¸š refresh JWT access tokens
- 1 user à¸¡à¸µà¹„à¸”à¹‰ 1 refresh token (One-to-One)

**Relationships**:
- Belongs-to: `users` (user_id)

---

### 3. ğŸ’¬ chat_sessions
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ**: à¸ˆà¸±à¸”à¹€à¸à¹‡à¸š chat sessions à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰à¹à¸•à¹ˆà¸¥à¸°à¸„à¸™

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: chat_sessions                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id              â”‚  UUID        â”‚  PK         â”‚  Session ID    â”‚
â”‚  user_id         â”‚  UUID        â”‚  FK         â”‚  Reference     â”‚
â”‚                  â”‚              â”‚             â”‚  to users.id    â”‚
â”‚  title           â”‚  STRING      â”‚             â”‚  Session title â”‚
â”‚  created_at      â”‚  TIMESTAMP   â”‚             â”‚  Created time  â”‚
â”‚  updated_at      â”‚  TIMESTAMP   â”‚             â”‚  Updated time  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- à¸ˆà¸±à¸”à¸à¸²à¸£ chat sessions (à¹à¸•à¹ˆà¸¥à¸°à¸à¸²à¸£à¸ªà¸™à¸—à¸™à¸²)
- à¹€à¸à¹‡à¸š title à¸‚à¸­à¸‡ chat à¹€à¸à¸·à¹ˆà¸­à¹à¸ªà¸”à¸‡à¹ƒà¸™ history
- à¸­à¸±à¸à¹€à¸”à¸— `updated_at` à¹€à¸¡à¸·à¹ˆà¸­à¸¡à¸µà¸à¸²à¸£à¸ªà¹ˆà¸‡à¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹ƒà¸«à¸¡à¹ˆ

**Relationships**:
- Belongs-to: `users` (user_id)
- One-to-Many: `chat_messages` (has many messages)

---

### 4. ğŸ’¬ chat_messages
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ**: à¸ˆà¸±à¸”à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¹ƒà¸™ chat sessions

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: chat_messages                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id              â”‚  INTEGER     â”‚  PK, AI     â”‚  Message ID    â”‚
â”‚  session_id      â”‚  UUID        â”‚  FK         â”‚  Reference     â”‚
â”‚                  â”‚              â”‚             â”‚  to chat_      â”‚
â”‚                  â”‚              â”‚             â”‚  sessions.id   â”‚
â”‚  role            â”‚  STRING      â”‚             â”‚  'user' or     â”‚
â”‚                  â”‚              â”‚             â”‚  'assistant'   â”‚
â”‚  content         â”‚  TEXT        â”‚             â”‚  Message text â”‚
â”‚  created_at      â”‚  TIMESTAMP   â”‚             â”‚  Created time  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸„à¸§à¸²à¸¡à¸—à¸µà¹ˆ user à¸ªà¹ˆà¸‡ (role = 'user')
- à¹€à¸à¹‡à¸šà¸„à¸³à¸•à¸­à¸šà¸—à¸µà¹ˆ LLM/AI à¸ªà¸£à¹‰à¸²à¸‡ (role = 'assistant')
- à¹„à¸¡à¹ˆà¸¡à¸µ `updated_at` à¹€à¸à¸£à¸²à¸° message à¹„à¸¡à¹ˆà¸¡à¸µà¸à¸²à¸£à¹à¸à¹‰à¹„à¸‚
- à¹€à¸£à¸µà¸¢à¸‡à¸¥à¸³à¸”à¸±à¸šà¸•à¸²à¸¡ `created_at` à¹€à¸à¸·à¹ˆà¸­à¹à¸ªà¸”à¸‡à¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸à¸²à¸£à¸ªà¸™à¸—à¸™à¸²

**Relationships**:
- Belongs-to: `chat_sessions` (session_id)
- Messages à¹ƒà¸™ session à¹€à¸”à¸µà¸¢à¸§à¸–à¸¹à¸à¸ˆà¸±à¸”à¹€à¸à¹‡à¸šà¸•à¸²à¸¡à¸¥à¸³à¸”à¸±à¸šà¹€à¸§à¸¥à¸²

---

### 5. ğŸ¢ businesses
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ**: à¸ˆà¸±à¸”à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸–à¸²à¸™à¸›à¸£à¸°à¸à¸­à¸šà¸à¸²à¸£ (Business listings)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: businesses                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id              â”‚  INTEGER     â”‚  PK, AI     â”‚  Business ID   â”‚
â”‚  user_id         â”‚  UUID        â”‚  FK         â”‚  Reference         â”‚
â”‚                  â”‚              â”‚             â”‚  to users.id    â”‚
â”‚  name            â”‚  STRING      â”‚  NOT NULL   â”‚  Business name  â”‚
â”‚  description     â”‚  TEXT        â”‚             â”‚  Description   â”‚
â”‚  business_type   â”‚  STRING      â”‚             â”‚  Type (à¹‚à¸£à¸‡à¹à¸£à¸¡   â”‚
â”‚                  â”‚              â”‚             â”‚  à¹Œ,à¸£à¹‰à¸²à¸™à¸­à¸²à¸«à¸²à¸£)    â”‚
â”‚  package_id      â”‚  INTEGER     â”‚             â”‚  Package ref    â”‚
â”‚  contact_email   â”‚  STRING      â”‚             â”‚  Contact email â”‚
â”‚  phone_number    â”‚  STRING      â”‚             â”‚  Phone number  â”‚
â”‚  website_url     â”‚  TEXT        â”‚             â”‚  Website URL   â”‚
â”‚  embedding       â”‚  VECTOR(1536)â”‚             â”‚  pgvector      â”‚
â”‚                  â”‚              â”‚             â”‚  embedding     â”‚
â”‚  is_active       â”‚  BOOLEAN     â”‚  DEF:true   â”‚  Active status â”‚
â”‚  created_at      â”‚  TIMESTAMP   â”‚             â”‚  Created time  â”‚
â”‚  updated_at      â”‚  TIMESTAMP   â”‚             â”‚  Updated time  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸–à¸²à¸™à¸›à¸£à¸°à¸à¸­à¸šà¸à¸²à¸£ (à¹‚à¸£à¸‡à¹à¸£à¸¡ à¸£à¹‰à¸²à¸™à¸­à¸²à¸«à¸²à¸£)
- à¹ƒà¸Šà¹‰ `embedding` (pgvector) à¸ªà¸³à¸«à¸£à¸±à¸š semantic search
- à¸„à¹‰à¸™à¸«à¸²à¸”à¹‰à¸§à¸¢ cosine similarity à¸ˆà¸²à¸ embeddings
- `is_active` à¹ƒà¸Šà¹‰à¸à¸£à¸­à¸‡à¸ªà¸–à¸²à¸™à¸—à¸µà¹ˆà¸—à¸µà¹ˆà¹€à¸›à¸´à¸”à¹ƒà¸«à¹‰à¸šà¸£à¸´à¸à¸²à¸£

**Relationships**:
- Belongs-to: `users` (user_id - owner)
- One-to-Many: `business_images` (à¸¡à¸µà¸£à¸¹à¸›à¸ à¸²à¸à¸«à¸¥à¸²à¸¢à¸£à¸¹à¸›)
- One-to-Many: `business_packages` (à¸¡à¸µà¸«à¸¥à¸²à¸¢ packages)

---

### 6. ğŸ“¦ packages
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ**: à¸ˆà¸±à¸”à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸à¹‡à¸„à¹€à¸à¸ˆà¸ªà¸³à¸«à¸£à¸±à¸š business subscription

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: packages                                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id              â”‚  INTEGER     â”‚  PK, AI     â”‚  Package ID    â”‚
â”‚  name            â”‚  STRING      â”‚             â”‚  Package name  â”‚
â”‚  price           â”‚  DECIMAL(10) â”‚             â”‚  Package price â”‚
â”‚  rate_limit_per  â”‚  INTEGER     â”‚             â”‚  API rate      â”‚
â”‚  _min            â”‚              â”‚             â”‚  limit/min     â”‚
â”‚  is_active       â”‚  BOOLEAN     â”‚  DEF:true   â”‚  Active status â”‚
â”‚  created_at      â”‚  TIMESTAMP   â”‚             â”‚  Created time  â”‚
â”‚  updated_at      â”‚  TIMESTAMP   â”‚             â”‚  Updated time  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¹à¸à¹‡à¸„à¹€à¸à¸ˆ subscription à¸ªà¸³à¸«à¸£à¸±à¸šà¸˜à¸¸à¸£à¸à¸´à¸ˆ
- à¸à¸³à¸«à¸™à¸” rate limiting à¸ªà¸³à¸«à¸£à¸±à¸šà¹à¸•à¹ˆà¸¥à¸°à¹à¸à¹‡à¸„à¹€à¸à¸ˆ
- `is_active` à¹ƒà¸Šà¹‰à¹€à¸›à¸´à¸”/à¸›à¸´à¸”à¸à¸²à¸£à¸‚à¸²à¸¢à¹à¸à¹‡à¸„à¹€à¸à¸ˆ

**Relationships**:
- One-to-Many: `subscriptions`, `transactions`, `businesses`

---

### 7. ğŸ”— business_packages
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ**: Join table à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡ businesses à¹à¸¥à¸° packages

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: business_packages                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  business_id     â”‚  INTEGER     â”‚  PK, FK     â”‚  Business ref   â”‚
â”‚  package_id      â”‚  INTEGER     â”‚  PK, FK     â”‚  Package ref    â”‚
â”‚  started_at      â”‚  TIMESTAMP   â”‚             â”‚  Start date     â”‚
â”‚  ended_at        â”‚  TIMESTAMP   â”‚             â”‚  End date       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- Many-to-Many relationship à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡ businesses à¹à¸¥à¸° packages
- à¹€à¸à¹‡à¸šà¸§à¸±à¸™à¸—à¸µà¹ˆà¹€à¸£à¸´à¹ˆà¸¡à¸•à¹‰à¸™à¹à¸¥à¸°à¸ªà¸´à¹‰à¸™à¸ªà¸¸à¸”à¸‚à¸­à¸‡ subscription

**Relationships**:
- Belongs-to: `businesses` (business_id)
- Belongs-to: `packages` (package_id)

---

### 8. ğŸ“¸ business_images
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„: à¹€à¸à¹‡à¸šà¸£à¸¹à¸›à¸ à¸²à¸à¸‚à¸­à¸‡à¸˜à¸¸à¸£à¸à¸´à¸ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: business_images                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id              â”‚  INTEGER     â”‚  PK, AI     â”‚  Image ID      â”‚
â”‚  business_id     â”‚  INTEGER     â”‚  FK         â”‚  Business ref   â”‚
â”‚  image_url       â”‚  STRING      â”‚             â”‚  Image URL     â”‚
â”‚  caption         â”‚  STRING      â”‚             â”‚  Caption       â”‚
â”‚  created_at      â”‚  TIMESTAMP   â”‚             â”‚  Created time  â”‚
â”‚  updated_at      â”‚  TIMESTAMP   â”‚             â”‚  Updated time  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- à¹€à¸à¹‡à¸šà¸£à¸¹à¸›à¸ à¸²à¸à¸‚à¸­à¸‡à¸˜à¸¸à¸£à¸à¸´à¸ˆ
- à¸£à¸­à¸‡à¸£à¸±à¸šà¸£à¸¹à¸›à¸ à¸²à¸à¹„à¸”à¹‰à¸«à¸¥à¸²à¸¢à¸£à¸¹à¸›à¸•à¹ˆà¸­à¸˜à¸¸à¸£à¸à¸´à¸ˆ
- à¹€à¸à¹‡à¸š caption à¸ªà¸³à¸«à¸£à¸±à¸šà¹à¸•à¹ˆà¸¥à¸°à¸£à¸¹à¸›à¸ à¸²à¸

**Relationships**:
- Belongs-to: `businesses` (business_id)

---

### 9. ğŸ’³ subscriptions
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ**: à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ subscription à¸‚à¸­à¸‡à¸œà¸¹à¹‰à¹ƒà¸Šà¹‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: subscriptions                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id              â”‚  INTEGER     â”‚  PK, AI     â”‚  Subscription IDâ”‚
â”‚  user_id         â”‚  UUID        â”‚  FK         â”‚  User ref      â”‚
â”‚  package_id      â”‚  INTEGER     â”‚  FK         â”‚  Package ref    â”‚
â”‚  status          â”‚  STRING      â”‚             â”‚  Status        â”‚
â”‚  started_at      â”‚  TIMESTAMP   â”‚             â”‚  Start date    â”‚
â”‚  ended_at        â”‚  TIMESTAMP   â”‚             â”‚  End date      â”‚
â”‚  created_at      â”‚  TIMESTAMP   â”‚             â”‚  Created time  â”‚
â”‚  updated_at      â”‚  TIMESTAMP   â”‚             â”‚  Updated time    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- à¸ˆà¸±à¸”à¸à¸²à¸£ subscription à¸‚à¸­à¸‡ users
- à¹€à¸à¹‡à¸šà¸ªà¸–à¸²à¸™à¸°à¹à¸¥à¸°à¸£à¸°à¸¢à¸°à¹€à¸§à¸¥à¸²à¸‚à¸­à¸‡ subscription
- à¹ƒà¸Šà¹‰à¸•à¸£à¸§à¸ˆà¸ªà¸­à¸šà¸ªà¸´à¸—à¸˜à¸´à¹Œà¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™ features

**Relationships**:
- Belongs-to: `users` (user_id)
- Belongs-to: `packages` (package_id)

---

### 10. ğŸ’° transactions
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ**: à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸à¸²à¸£à¸—à¸³à¸˜à¸¸à¸£à¸à¸£à¸£à¸¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: transactions                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id              â”‚  INTEGER     â”‚  PK, AI     â”‚  Transaction IDâ”‚
â”‚  user_id         â”‚  UUID        â”‚  FK         â”‚  User ref      â”‚
â”‚  package_id      â”‚  INTEGER     â”‚  FK         â”‚  Package ref    â”‚
â”‚  promotion_id    â”‚  INTEGER     â”‚  FK         â”‚  Promotion ref  â”‚
â”‚  amount          â”‚  DECIMAL(10) â”‚             â”‚  Amount paid   â”‚
â”‚  status          â”‚  STRING      â”‚             â”‚  Status        â”‚
â”‚  created_at      â”‚  TIMESTAMP   â”‚             â”‚  Created time  â”‚
â”‚  updated_at      â”‚  TIMESTAMP   â”‚             â”‚  Updated time  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- à¹€à¸à¹‡à¸šà¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸à¸²à¸£à¸—à¸³à¸˜à¸¸à¸£à¸à¸£à¸£à¸¡
- à¸£à¸­à¸‡à¸£à¸±à¸š promotion codes
- à¹ƒà¸Šà¹‰à¸ªà¸³à¸«à¸£à¸±à¸š payment tracking

**Relationships**:
- Belongs-to: `users` (user_id)
- Belongs-to: `packages` (package_id)
- Belongs-to: `promotions` (promotion_id)

---

### 11. ğŸ promotions
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ**: à¹€à¸à¹‡à¸šà¸‚à¹‰à¸­à¸¡à¸¹à¸¥ promotion codes

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: promotions                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id              â”‚  INTEGER     â”‚  PK, AI     â”‚  Promotion ID  â”‚
â”‚  code            â”‚  STRING      â”‚  UNIQUE     â”‚  Promo code    â”‚
â”‚  discount        â”‚  DECIMAL     â”‚             â”‚  Discount %    â”‚
â”‚  is_active       â”‚  BOOLEAN     â”‚             â”‚  Active status â”‚
â”‚  created_at      â”‚  TIMESTAMP   â”‚             â”‚  Created time  â”‚
â”‚  updated_at      â”‚  TIMESTAMP   â”‚             â”‚  Updated time  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- à¸ˆà¸±à¸”à¹€à¸à¹‡à¸š promotion codes
- à¹ƒà¸Šà¹‰à¸¥à¸”à¸£à¸²à¸„à¸²à¹ƒà¸™à¸à¸²à¸£à¸‹à¸·à¹‰à¸­à¹à¸à¹‡à¸„à¹€à¸à¸ˆ

**Relationships**:
- One-to-Many: `transactions`

---

### 12. ğŸ§¾ payment_slips
**à¸§à¸±à¸•à¸–à¸¸à¸›à¸£à¸°à¸ªà¸‡à¸„à¹Œ**: à¹€à¸à¹‡à¸šà¸«à¸¥à¸±à¸à¸à¸²à¸™à¸à¸²à¸£à¸Šà¸³à¸£à¸°à¹€à¸‡à¸´à¸™ (slip images)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Table: payment_slips                                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Column          â”‚  Type        â”‚  Constraintsâ”‚  Description   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  id              â”‚  INTEGER     â”‚  PK, AI     â”‚  Slip ID       â”‚
â”‚  transaction_id  â”‚  INTEGER     â”‚  FK         â”‚  Transaction   â”‚
â”‚  user_id         â”‚  UUID        â”‚  FK         â”‚  User ref      â”‚
â”‚  image_url       â”‚  STRING      â”‚             â”‚  Slip image URLâ”‚
â”‚  status          â”‚  STRING      â”‚             â”‚  Status        â”‚
â”‚  created_at      â”‚  TIMESTAMP   â”‚             â”‚  Created time  â”‚
â”‚  updated_at      â”‚  TIMESTAMP   â”‚             â”‚  Updated time  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**à¸à¸²à¸£à¹ƒà¸Šà¹‰à¸‡à¸²à¸™**:
- à¹€à¸à¹‡à¸šà¹„à¸Ÿà¸¥à¹Œà¸£à¸¹à¸›à¸ à¸²à¸à¸‚à¸­à¸‡à¸ªà¸¥à¸´à¸›à¸à¸²à¸£à¸Šà¸³à¸£à¸°à¹€à¸‡à¸´à¸™
- à¹ƒà¸Šà¹‰à¸ªà¸³à¸«à¸£à¸±à¸šà¸à¸²à¸£à¸¢à¸·à¸™à¸¢à¸±à¸™à¸à¸²à¸£à¸Šà¸³à¸£à¸°à¹€à¸‡à¸´à¸™à¸ˆà¸²à¸ admin

**Relationships**:
- Belongs-to: `transactions` (transaction_id)
- Belongs-to: `users` (user_id)

---

## ğŸ”— Entity Relationships (ER)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Database Relationships                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

User (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) ChatSession
User (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) Business
User (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (1) Token
User (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) Subscription
User (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) Transaction
User (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) PaymentSlip

ChatSession (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) ChatMessage

Business (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) BusinessImage
Business (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) BusinessPackage

Package (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) Subscription
Package (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) Transaction
Package (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) BusinessPackage

Promotion (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) Transaction

Transaction (1) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–º (many) PaymentSlip
```

---

## ğŸ¯ Database Design Principles

### 1. **Normalization**
- à¸•à¸²à¸£à¸²à¸‡à¹à¸¢à¸à¸•à¸²à¸¡à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆà¸Šà¸±à¸”à¹€à¸ˆà¸™ (users, sessions, messages)
- à¸«à¸¥à¸µà¸à¹€à¸¥à¸µà¹ˆà¸¢à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸‹à¹‰à¸³à¸‹à¹‰à¸­à¸™
- à¹ƒà¸Šà¹‰ foreign keys à¹€à¸à¸·à¹ˆà¸­ integrity

### 2. **Indexing**
- **Primary Keys**: à¸—à¸±à¹‰à¸‡ UUID à¹à¸¥à¸° INTEGER (auto-increment)
- **Foreign Keys**: à¹à¸šà¸š cascading deletes à¸ªà¸³à¸«à¸£à¸±à¸š relationships à¸—à¸µà¹ˆà¹€à¸«à¸¡à¸²à¸°à¸ªà¸¡
- **Unique Constraints**: email (users), code (promotions)

### 3. **Vector Search (pgvector)**
- **Field**: `embedding` à¹ƒà¸™ `businesses` table
- **Type**: `vector(1536)` (1536 dimensions)
- **Use Case**: Semantic search à¸ªà¸³à¸«à¸£à¸±à¸šà¸„à¹‰à¸™à¸«à¸²à¸˜à¸¸à¸£à¸à¸´à¸ˆà¸•à¸²à¸¡à¸„à¸³à¸­à¸˜à¸´à¸šà¸²à¸¢
- **Query**: Cosine similarity (`<=>` operator)

### 4. **Timestamps**
- **Standard**: `created_at`, `updated_at`
- **Exceptions**: `chat_messages` à¹„à¸¡à¹ˆà¸¡à¸µ `updated_at` (à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ immutable)

### 5. **Soft Deletes**
- **Pattern**: `is_active`, `is_suspended`, `is_protected` flags
- **Purpose**: à¹€à¸à¹‡à¸šà¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸‚à¹‰à¸­à¸¡à¸¹à¸¥ à¹à¸—à¸™à¸à¸²à¸£à¸¥à¸šà¸–à¸²à¸§à¸£

### 6. **UUID vs INTEGER**
- **UUID**: users, sessions (distributed systems)
- **INTEGER**: Businesses, transactions (performance)

---

## ğŸ” Query Patterns

### 1. **Authentication Flow**
```sql
-- Find user by email
SELECT * FROM users WHERE email = 'user@example.com';

-- Get refresh token
SELECT refresh_token FROM tokens WHERE user_id = ?
```

### 2. **Chat History**
```sql
-- Get all sessions for user
SELECT * FROM chat_sessions WHERE user_id = ? ORDER BY updated_at DESC;

-- Get messages in session
SELECT * FROM chat_messages WHERE session_id = ? ORDER BY created_at ASC;
```

### 3. **Semantic Search**
```sql
-- Find businesses by embedding similarity
SELECT id, name, embedding
FROM businesses
WHERE embedding <=> ?::vector
ORDER BY embedding <=> ?::vector
LIMIT 10;
```

---

**Updated**: October 28, 2025
**Database Version**: PostgreSQL 15 + pgvector
