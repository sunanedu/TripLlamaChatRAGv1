# ‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô LLM Chat Development System

## üìã Services ‡πÉ‡∏ô docker-compose.dev.yml

### üîß Services ‡∏ó‡∏µ‡πà‡∏°‡∏µ
1. **llm-chat-api** - Backend API (Node.js)
2. **llm-chat-frontend** - React Dev Frontend 
3. **llm-chat-pwa** - PWA Production Build
4. **llm-chat-database** - PostgreSQL (with pgvector)
5. **llm-chat-cache** - Redis
6. **llm-chat-worker** - Background Jobs Worker
7. **llm-chat-embedder** - Mock Embedding Service

### üì¶ Container Names
‡∏ó‡∏∏‡∏Å service ‡πÉ‡∏ä‡πâ‡∏ä‡∏∑‡πà‡∏≠ container ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô: `vit-{service-name}-1`
- `vit-llm-chat-api-1`
- `vit-llm-chat-frontend-1`
- `vit-llm-chat-pwa-1`
- `vit-llm-chat-database-1`
- `vit-llm-chat-cache-1`
- `vit-llm-chat-worker-1`
- `vit-llm-chat-embedder-1`

---

## üöÄ ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### 1. Start Ollama (‡∏ï‡πâ‡∏≠‡∏á‡∏ó‡∏≥‡∏Å‡πà‡∏≠‡∏ô!)
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ Ollama ‡∏£‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà
curl http://localhost:11434/api/tags

# ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ ‡πÉ‡∏´‡πâ start Ollama
OLLAMA_HOST=0.0.0.0:11434 ollama serve > /tmp/ollama.log 2>&1 &
```

### 2. ‡πÄ‡∏£‡∏¥‡πà‡∏° Services ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
```bash
cd /home/vit

# ‡πÄ‡∏£‡∏¥‡πà‡∏° services ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
docker-compose -f docker-compose.dev.yml up -d

# ‡∏î‡∏π status
docker-compose -f docker-compose.dev.yml ps

# ‡∏î‡∏π logs ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
docker-compose -f docker-compose.dev.yml logs -f
```

### 3. ‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

#### Login Credentials
- **Email:** `admin@example.com`
- **Password:** `1234`

‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ users ‡∏≠‡∏∑‡πà‡∏ô‡πÜ:
- `staff@example.com` / `1234`
- `member@example.com` / `1234`  
- `guest@example.com` / `1234`

#### URLs
- **Frontend Dev:** http://localhost:5173
- **PWA Production:** http://localhost:5174
- **API:** http://localhost:3000/api

---

## üîÑ ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô

### ‡∏î‡∏π Status
```bash
# ‡∏î‡∏π services ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
docker-compose -f docker-compose.dev.yml ps

# ‡∏î‡∏π logs
docker-compose -f docker-compose.dev.yml logs llm-chat-api
docker-compose -f docker-compose.dev.yml logs llm-chat-pwa
docker-compose -f docker-compose.dev.yml logs llm-chat-frontend
```

### Restart Services
```bash
# Restart service ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß
docker-compose -f docker-compose.dev.yml restart llm-chat-api

# Restart ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
docker-compose -f docker-compose.dev.yml restart
```

### Stop/Start Services
```bash
# Stop ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
docker-compose -f docker-compose.dev.yml stop

# Start ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
docker-compose -f docker-compose.dev.yml start

# Stop ‡πÅ‡∏•‡∏∞‡∏•‡∏ö containers
docker-compose -f docker-compose.dev.yml down
```

---

## üîß ‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå

### ‚ö†Ô∏è ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏à‡∏≠: ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏•‡πâ‡∏ß‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó

### 1. **Backend (llm-chat-api)** - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
```bash
# Backend ‡πÉ‡∏ä‡πâ nodemon - auto reload
# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô ./llm-chat-backend/src/
# ‚Üí nodemon ‡∏à‡∏∞ reload ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

# ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó ‡πÉ‡∏´‡πâ restart
docker-compose -f docker-compose.dev.yml restart llm-chat-api

# ‡∏î‡∏π logs
docker-compose -f docker-compose.dev.yml logs -f llm-chat-api
```

**‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ Hot Reload:**
- `./llm-chat-backend/src/**/*.js`
- `./llm-chat-backend/src/**/*.json`

### 2. **Frontend Dev (llm-chat-frontend)** - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
```bash
# Frontend ‡πÉ‡∏ä‡πâ Vite - auto reload
# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô ./llm-chat-frontend/src/
# ‚Üí Vite ‡∏à‡∏∞ reload ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÉ‡∏ô browser

# ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó
# 1. Hard refresh browser: Ctrl+Shift+R (‡∏´‡∏£‡∏∑‡∏≠ Ctrl+F5)
# 2. ‡∏´‡∏£‡∏∑‡∏≠ restart service
docker-compose -f docker-compose.dev.yml restart llm-chat-frontend
```

**‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏°‡∏µ Hot Reload:**
- `./llm-chat-frontend/src/**/*.tsx`
- `./llm-chat-frontend/src/**/*.ts`
- `./llm-chat-frontend/src/**/*.css`

### 3. **PWA (llm-chat-pwa)** - ‡∏ï‡πâ‡∏≠‡∏á Rebuild!
```bash
# PWA ‡πÄ‡∏õ‡πá‡∏ô production build - ‡∏ï‡πâ‡∏≠‡∏á rebuild ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á

# ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 1: Rebuild ‡∏ú‡πà‡∏≤‡∏ô npm (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)
cd /home/vit/llm-chat-frontendpwa
npm run build
docker cp dist/. vit-llm-chat-pwa-1:/usr/share/nginx/html/

# ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 2: Rebuild Docker image
cd /home/vit
docker-compose -f docker-compose.dev.yml up -d --build llm-chat-pwa

# ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏µ‡πà 3: Restart service (‡∏ñ‡πâ‡∏≤‡πÑ‡∏ü‡∏•‡πå‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô container)
docker-compose -f docker-compose.dev.yml restart llm-chat-pwa
```

**‡πÑ‡∏ü‡∏•‡πå‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á rebuild:**
- `./llm-chat-frontendpwa/src/**/*.tsx`
- `./llm-chat-frontendpwa/src/**/*.ts`
- `./llm-chat-frontendpwa/Dockerfile`
- `./llm-chat-frontendpwa/vite.config.ts`

### 4. **Worker (llm-chat-worker)** - ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
```bash
# Worker ‡πÉ‡∏ä‡πâ nodemon ‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô backend
# ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô ./llm-chat-backend/src/
# ‚Üí nodemon ‡∏à‡∏∞ reload ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥

# ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó
docker-compose -f docker-compose.dev.yml restart llm-chat-worker
```

### 5. **Database/Redis/Embedder** - ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
- Services ‡πÄ‡∏´‡∏•‡πà‡∏≤‡∏ô‡∏µ‡πâ‡πÉ‡∏ä‡πâ image ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏≠‡∏¢‡∏π‡πà‡πÅ‡∏•‡πâ‡∏ß
- ‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÇ‡∏Ñ‡πâ‡∏î‡πÉ‡∏ô development

---

## üîç ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏û‡∏ö‡∏ö‡πà‡∏≠‡∏¢

### API ‡πÑ‡∏°‡πà‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
```bash
# 1. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö Ollama
curl http://localhost:11434/api/tags

# 2. ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ
OLLAMA_HOST=0.0.0.0:11434 ollama serve &
docker-compose -f docker-compose.dev.yml restart llm-chat-api

# 3. ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API logs
docker-compose -f docker-compose.dev.yml logs llm-chat-api | grep -i error
```

### Frontend ‡πÑ‡∏°‡πà‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
```bash
# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö API
curl http://localhost:3000/api

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö logs
docker-compose -f docker-compose.dev.yml logs llm-chat-api

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö network ‡πÉ‡∏ô browser
# F12 ‚Üí Network tab
```

### PWA ‡πÉ‡∏ä‡πâ‡∏´‡∏ô‡πâ‡∏≤‡∏ï‡∏≤‡πÄ‡∏Å‡πà‡∏≤ (cached)
```bash
# 1. Hard refresh: Ctrl+Shift+R
# 2. ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏¥‡∏î Incognito window
# 3. ‡∏´‡∏£‡∏∑‡∏≠ unregister service worker ‡πÉ‡∏ô browser console
# 4. ‡∏´‡∏£‡∏∑‡∏≠ rebuild
docker-compose -f docker-compose.dev.yml up -d --build llm-chat-pwa
```

---

## üóëÔ∏è ‡∏•‡∏ö‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà

### ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
```bash
# Stop ‡πÅ‡∏•‡∏∞‡∏•‡∏ö containers, networks
docker-compose -f docker-compose.dev.yml down

# ‡∏•‡∏ö volumes (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏∞‡∏´‡∏≤‡∏¢!)
docker-compose -f docker-compose.dev.yml down -v

# ‡∏•‡∏ö images
docker rmi vit-llm-chat-api vit-llm-chat-pwa vit-llm-chat-embedder

# ‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà
docker-compose -f docker-compose.dev.yml up -d --build
```

### ‡∏•‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞ service ‡∏´‡∏ô‡∏∂‡πà‡∏á
```bash
# ‡∏•‡∏ö service
docker-compose -f docker-compose.dev.yml rm -f -s llm-chat-api

# ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà
docker-compose -f docker-compose.dev.yml up -d llm-chat-api
```

---

## üìä Structure Overview

```
/home/vit/
‚îú‚îÄ‚îÄ docker-compose.dev.yml       # Config file ‡∏´‡∏•‡∏±‡∏Å
‚îú‚îÄ‚îÄ llm-chat-backend/            # Backend API
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ controllers/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ routes/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile.dev
‚îú‚îÄ‚îÄ llm-chat-frontend/           # React Dev Frontend
‚îÇ   ‚îî‚îÄ‚îÄ src/
‚îú‚îÄ‚îÄ llm-chat-frontendpwa/        # PWA Production
‚îÇ   ‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ dist/                     # Build output
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îú‚îÄ‚îÄ mock-embedder/                # Mock Embedding Service
‚îÇ   ‚îî‚îÄ‚îÄ index.js
‚îî‚îÄ‚îÄ HowtoUse.md                   # ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ
```

---

## üéØ Quick Reference

### ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Backend
```bash
# Edit: ./llm-chat-backend/src/**/*.js
# Auto reload - nodemon
```

### ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç Frontend Dev  
```bash
# Edit: ./llm-chat-frontend/src/**/*.tsx
# Auto reload - Vite
# Hard refresh browser: Ctrl+Shift+R
```

### ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç PWA
```bash
# Edit: ./llm-chat-frontendpwa/src/**/*.tsx
cd /home/vit/llm-chat-frontendpwa
npm run build
docker cp dist/. vit-llm-chat-pwa-1:/usr/share/nginx/html/
# ‡∏´‡∏£‡∏∑‡∏≠ rebuild: docker-compose -f docker-compose.dev.yml up -d --build llm-chat-pwa
```

### ‡∏î‡∏π Logs
```bash
docker-compose -f docker-compose.dev.yml logs -f [service-name]
```

### Restart Service
```bash
docker-compose -f docker-compose.dev.yml restart [service-name]
```

### Rebuild Service
```bash
docker-compose -f docker-compose.dev.yml up -d --build [service-name]
```

---

## üÜò Troubleshooting

### Container ‡πÑ‡∏°‡πà start
```bash
# ‡∏î‡∏π logs
docker-compose -f docker-compose.dev.yml logs [service-name]

# ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö dependencies
docker-compose -f docker-compose.dev.yml ps

# Check network
docker network ls | grep llm-chat
```

### Port already in use
```bash
# ‡∏´‡∏≤ process ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ port
sudo lsof -i :3000
sudo lsof -i :5173
sudo lsof -i :5174

# Kill process
sudo kill -9 [PID]

# ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô port ‡πÉ‡∏ô docker-compose.dev.yml
```

### Database connection error
```bash
# Check database
docker-compose -f docker-compose.dev.yml logs llm-chat-database

# Restart database
docker-compose -f docker-compose.dev.yml restart llm-chat-database

# Check connection string ‡πÉ‡∏ô .env
cat ./llm-chat-backend/.env | grep DATABASE_URL
```

---

## üìù Notes

- **Ollama** ‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà host (‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÉ‡∏ô container)
- **Database & Redis** ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô volumes - ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏´‡∏≤‡∏¢‡πÄ‡∏°‡∏∑‡πà‡∏≠ restart
- **Frontend Dev** - Hot reload ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- **Backend & Worker** - Hot reload ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
- **PWA** - ‡∏ï‡πâ‡∏≠‡∏á rebuild ‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç

---

## üîó Related Files

- `docker-compose.dev.yml` - Docker Compose configuration
- `llm-chat-frontendpwa/DEPLOY.md` - PWA Deployment Guide
- `PWA_SUCCESS.md` - PWA Implementation Summary
- `MEMBERS.md` - Test User Credentials

