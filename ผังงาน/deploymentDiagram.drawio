<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/28.2.7 Chrome/138.0.7204.251 Electron/37.7.1 Safari/537.36" version="28.2.7">
  <diagram name="Deployment Diagram" id="deployment-diagram">
    <mxGraphModel dx="2066" dy="1209" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="2400" pageHeight="1600" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="title" value="ðŸš€ Deployment Diagram - Sri-KetGuide" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=28;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="410" y="100" width="800" height="50" as="geometry" />
        </mxCell>
        <mxCell id="internet" value="ðŸŒ Internet&#xa;Public Access" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5ff;strokeColor=#01579b;strokeWidth=3;fontSize=16" parent="1" vertex="1">
          <mxGeometry x="150" y="230" width="300" height="80" as="geometry" />
        </mxCell>
        <mxCell id="cloudflare-title" value="â˜ï¸ Cloudflare Tunnels" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="550" y="190" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="cf-frontend" value="ðŸŒ Frontend Tunnel&#xa;frontend.sri-ketguide.com&#xa;Container: cf-tunnel-frontend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;strokeWidth=2;fontSize=12" parent="1" vertex="1">
          <mxGeometry x="500" y="230" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="cf-api" value="ðŸš€ API Tunnel&#xa;api.sri-ketguide.com&#xa;Container: cf-tunnel-api" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;strokeWidth=2;fontSize=12" parent="1" vertex="1">
          <mxGeometry x="750" y="230" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="cf-pwa" value="ðŸ“± PWA Tunnel&#xa;pwa.sri-ketguide.com&#xa;Container: cf-tunnel-prod" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;strokeWidth=2;fontSize=12" parent="1" vertex="1">
          <mxGeometry x="1000" y="230" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="cf-webhooks" value="ðŸ”” Webhooks Tunnel&#xa;webhooks.sri-ketguide.com&#xa;Container: cf-tunnel-webhooks" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;strokeWidth=2;fontSize=12" parent="1" vertex="1">
          <mxGeometry x="1250" y="230" width="200" height="100" as="geometry" />
        </mxCell>
        <mxCell id="docker-network-title" value="ðŸ³ Docker Network (llm-chat-network)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="130" y="390" width="800" height="30" as="geometry" />
        </mxCell>
        <mxCell id="frontend-title" value="Frontend Layer" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="250" y="430" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="frontend" value="ðŸŒ Frontend SPA&#xa;Container: sri_prod-llm-chat-frontend-1&#xa;Port: 80&#xa;Nginx + Vite Build" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5ff;strokeColor=#01579b;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="250" y="460" width="220" height="120" as="geometry" />
        </mxCell>
        <mxCell id="pwa" value="ðŸ“± PWA App&#xa;Container: sri_prod-llm-chat-pwa-1&#xa;Port: 80&#xa;Progressive Web App" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5ff;strokeColor=#01579b;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="500" y="460" width="220" height="120" as="geometry" />
        </mxCell>
        <mxCell id="app-title" value="Application Layer" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="210" y="610" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="api" value="ðŸš€ LLM Chat API&#xa;Container: sri_prod-llm-chat-api-1&#xa;Port: 3000&#xa;Express.js + Node.js" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#4a148c;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="250" y="650" width="220" height="120" as="geometry" />
        </mxCell>
        <mxCell id="messaging-gateway" value="ðŸ’¬ Messaging Gateway&#xa;Container: messaging-gateway&#xa;Port: 8080&#xa;LINE/FB/Telegram Integration" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#4a148c;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="500" y="650" width="220" height="120" as="geometry" />
        </mxCell>
        <mxCell id="worker" value="âš™ï¸ BullMQ Worker&#xa;Container: sri_prod-llm-chat-worker-1&#xa;Background Jobs&#xa;Embedding Generation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#4a148c;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="750" y="650" width="220" height="120" as="geometry" />
        </mxCell>
        <mxCell id="data-title" value="Data Layer" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="270" y="810" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="postgres" value="ðŸ—„ï¸ PostgreSQL&#xa;Container: sri_prod-llm-chat-database-1&#xa;Port: 5432&#xa;+ pgvector Extension&#xa;&#xa;Volume: vit_postgres_data" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="250" y="840" width="220" height="140" as="geometry" />
        </mxCell>
        <mxCell id="redis" value="âš¡ Redis Cache&#xa;Container: sri_prod-llm-chat-cache-1&#xa;Port: 6379&#xa;BullMQ Queue Backend&#xa;&#xa;Volume: redis_data" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="500" y="840" width="220" height="140" as="geometry" />
        </mxCell>
        <mxCell id="ai-title" value="AI Services" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="820" y="820" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="ollama" value="ðŸ¤– Ollama LLM&#xa;Container: sri_prod-llm-chat-embedder-1&#xa;Port: 11434 (generate)&#xa;Port: 11400 (embeddings)&#xa;Model: llama3.2 (7B)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#880e4f;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="750" y="840" width="220" height="140" as="geometry" />
        </mxCell>
        <mxCell id="tables-title" value="Database Tables" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="1050" y="430" width="150" height="20" as="geometry" />
        </mxCell>
        <mxCell id="table-users" value="ðŸ‘¥ users&#xa;â€¢ email&#xa;â€¢ password_hash&#xa;â€¢ role&#xa;â€¢ is_suspended" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0f2f1;strokeColor=#004d40;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="1050" y="460" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="table-chat-sessions" value="ðŸ“ chat_sessions&#xa;â€¢ id&#xa;â€¢ user_id&#xa;â€¢ title&#xa;â€¢ created_at" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0f2f1;strokeColor=#004d40;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="1050" y="580" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="table-chat-messages" value="ðŸ’¬ chat_messages&#xa;â€¢ id&#xa;â€¢ session_id&#xa;â€¢ role&#xa;â€¢ content" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0f2f1;strokeColor=#004d40;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="1050" y="700" width="180" height="100" as="geometry" />
        </mxCell>
        <mxCell id="table-businesses" value="ðŸ¢ businesses&#xa;â€¢ id&#xa;â€¢ name&#xa;â€¢ description&#xa;â€¢ embedding (vector)&#xa;â€¢ embedding_status" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0f2f1;strokeColor=#004d40;strokeWidth=2;fontSize=11" parent="1" vertex="1">
          <mxGeometry x="1050" y="820" width="180" height="120" as="geometry" />
        </mxCell>
        <mxCell id="arrow-internet-frontend" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="internet" target="cf-frontend" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="490" y="270" />
              <mxPoint x="490" y="270" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-internet-api" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="internet" target="cf-api" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="300" y="180" />
              <mxPoint x="850" y="180" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-internet-pwa" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="internet" target="cf-pwa" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="300" y="180" />
              <mxPoint x="1100" y="180" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-internet-webhooks" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="internet" target="cf-webhooks" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="300" y="180" />
              <mxPoint x="1350" y="180" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-cf-frontend" value="HTTPS â†’ HTTP" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="cf-frontend" target="frontend" edge="1">
          <mxGeometry x="-0.0811" y="-10" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="600" y="340" />
              <mxPoint x="360" y="340" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-cf-pwa" value="HTTPS â†’ HTTP" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="cf-pwa" target="pwa" edge="1">
          <mxGeometry x="-0.2281" y="-10" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1100" y="400" />
              <mxPoint x="850" y="400" />
              <mxPoint x="850" y="520" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-cf-api" value="HTTPS â†’ HTTP" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="cf-api" target="api" edge="1">
          <mxGeometry x="0.1481" y="-10" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="850" y="360" />
              <mxPoint x="200" y="360" />
              <mxPoint x="200" y="710" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-cf-webhooks" value="HTTPS â†’ HTTP" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="cf-webhooks" target="messaging-gateway" edge="1">
          <mxGeometry x="-0.1321" y="-10" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1350" y="370" />
              <mxPoint x="740" y="370" />
              <mxPoint x="740" y="710" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-frontend-api" value="POST /api/*" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="frontend" target="api" edge="1">
          <mxGeometry x="-0.4286" y="-40" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-api-db" value="Sequelize ORM" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="api" target="postgres" edge="1">
          <mxGeometry x="-0.1429" y="-40" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-api-redis" value="BullMQ Queue" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="api" target="redis" edge="1">
          <mxGeometry y="10" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="360" y="790" />
              <mxPoint x="570" y="790" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-api-ollama" value="POST /api/generate" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="api" target="ollama" edge="1">
          <mxGeometry x="-0.0097" y="10" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="390" y="610" />
              <mxPoint x="1020" y="610" />
              <mxPoint x="1020" y="920" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-worker-redis" value="Pull Jobs" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="worker" target="redis" edge="1">
          <mxGeometry x="0.0345" y="-10" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="830" y="820" />
              <mxPoint x="610" y="820" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-worker-db" value="Update Embeddings" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="worker" target="postgres" edge="1">
          <mxGeometry x="-0.1304" y="-10" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="830" y="800" />
              <mxPoint x="420" y="800" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-worker-ollama" value="POST /embeddings" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="worker" target="ollama" edge="1">
          <mxGeometry y="-50" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1000" y="710" />
              <mxPoint x="1000" y="890" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-gateway-api" value="POST /api/internal/messaging-gateway" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" edge="1">
          <mxGeometry x="0.3333" y="-79" relative="1" as="geometry">
            <mxPoint x="500" y="709" as="sourcePoint" />
            <mxPoint x="470" y="709" as="targetPoint" />
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-db-users" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="postgres" target="table-users" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="360" y="1040" />
              <mxPoint x="1310" y="1040" />
              <mxPoint x="1310" y="510" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-db-sessions" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="postgres" target="table-chat-sessions" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="360" y="1040" />
              <mxPoint x="1310" y="1040" />
              <mxPoint x="1310" y="630" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-db-messages" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="postgres" target="table-chat-messages" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="360" y="1040" />
              <mxPoint x="1310" y="1040" />
              <mxPoint x="1310" y="750" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="arrow-db-businesses" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" parent="1" source="postgres" target="table-businesses" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="360" y="1040" />
              <mxPoint x="1310" y="1040" />
              <mxPoint x="1310" y="880" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="legend-title" value="Legend" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="1350" y="430" width="100" height="20" as="geometry" />
        </mxCell>
        <mxCell id="legend-frontend" value="Frontend" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5ff;strokeColor=#01579b;strokeWidth=2;fontSize=10" parent="1" vertex="1">
          <mxGeometry x="1350" y="460" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend-api" value="Application" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#4a148c;strokeWidth=2;fontSize=10" parent="1" vertex="1">
          <mxGeometry x="1350" y="500" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend-data" value="Data Layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=2;fontSize=10" parent="1" vertex="1">
          <mxGeometry x="1350" y="540" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend-ai" value="AI Services" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#880e4f;strokeWidth=2;fontSize=10" parent="1" vertex="1">
          <mxGeometry x="1350" y="580" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend-tunnel" value="Cloudflare" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff3e0;strokeColor=#e65100;strokeWidth=2;fontSize=10" parent="1" vertex="1">
          <mxGeometry x="1350" y="620" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="legend-tables" value="Database Tables" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0f2f1;strokeColor=#004d40;strokeWidth=2;fontSize=10" parent="1" vertex="1">
          <mxGeometry x="1350" y="660" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Kkg8tl0Y-xqTlZL6llgN-2" value="" style="endArrow=none;dashed=1;html=1;dashPattern=1 3;strokeWidth=2;rounded=0;" edge="1" parent="1">
          <mxGeometry width="50" height="50" relative="1" as="geometry">
            <mxPoint x="480" y="700" as="sourcePoint" />
            <mxPoint x="480" y="640" as="targetPoint" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
