<!-- Business Registration, Package & Payment Flow Diagram -->
<!-- LLM Chat System - Business Management Flow -->
<!-- Format: draw.io XML -->

<mxfile host="app.diagrams.net">
  <diagram name="Business &amp; Payment Flow" id="business-payment-flow">
    <mxGraphModel dx="2400" dy="1600" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="2000" pageHeight="1600" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <!-- Title -->
        <mxCell id="title" value="ðŸ“‹ Business Registration, Package &amp; Payment Flow Diagram" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=28;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="400" y="20" width="1200" height="50" as="geometry" />
        </mxCell>

        <!-- PART 1: Business Registration -->
        <mxCell id="part1-title" value="PART 1: Business Registration" style="text;html=1;strokeColor=none;fillColor=#e8f5e9;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=18;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="50" y="100" width="1900" height="40" as="geometry" />
        </mxCell>

        <!-- User Starts -->
        <mxCell id="user-start" value="ðŸ‘¤ User (Sponsor/Member)&#xa;Opens Sponsor Portal" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5ff;strokeColor=#01579b;strokeWidth=2;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="50" y="170" width="200" height="80" as="geometry" />
        </mxCell>

        <!-- Registration Form -->
        <mxCell id="reg-form" value="ðŸ“ Registration Form&#xa;Business Information:&#xa;â€¢ Name&#xa;â€¢ Description&#xa;â€¢ Business Type&#xa;â€¢ Contact Info" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="300" y="170" width="250" height="120" as="geometry" />
        </mxCell>

        <!-- Submit Registration -->
        <mxCell id="submit-reg" value="ðŸš€ POST /api/businesses&#xa;Create Business" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#4a148c;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="600" y="170" width="200" height="80" as="geometry" />
        </mxCell>

        <!-- Business Controller -->
        <mxCell id="business-controller" value="ðŸŽ¯ Business Controller&#xa;createBusiness()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0f2f1;strokeColor=#004d40;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="850" y="170" width="200" height="80" as="geometry" />
        </mxCell>

        <!-- Create Business -->
        <mxCell id="create-business" value="ðŸ’¾ Create Business&#xa;INSERT INTO businesses&#xa;(id, name, description,&#xa; user_id, package_id)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="1100" y="170" width="250" height="120" as="geometry" />
        </mxCell>

        <!-- Auto Assign Free Package -->
        <mxCell id="auto-package" value="ðŸ“¦ Auto Assign Free Package&#xa;Find Free Package&#xa;(price = 0)&#xa;Create BusinessPackage&#xa;status = 'active'" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#1b5e20;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="1400" y="170" width="250" height="140" as="geometry" />
        </mxCell>

        <!-- Auto Embedding -->
        <mxCell id="auto-embedding" value="ðŸ¤– Auto-Enqueue Embedding&#xa;debouncedEnqueueEmbedding()&#xa;Add to BullMQ Queue&#xa;embedding_status = 'queued'" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#880e4f;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="1700" y="170" width="250" height="140" as="geometry" />
        </mxCell>

        <!-- Response -->
        <mxCell id="reg-response" value="âœ… Response: Business Created&#xa;201 Created&#xa;{id, name, description, ...}" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#1b5e20;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="50" y="320" width="250" height="100" as="geometry" />
        </mxCell>

        <!-- Arrows Part 1 -->
        <mxCell id="arrow1" value="1. Fill Form" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="user-start" target="reg-form">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow2" value="2. Submit" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="reg-form" target="submit-reg">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow3" value="3. Route" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="submit-reg" target="business-controller">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow4" value="4. Create" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="business-controller" target="create-business">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow5" value="5. Assign Package" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="create-business" target="auto-package">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow6" value="6. Enqueue Embedding" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="create-business" target="auto-embedding">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow7" value="7. Return Success" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="business-controller" target="reg-response">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- PART 2: Business Package & Limit -->
        <mxCell id="part2-title" value="PART 2: Business, Package &amp; Limit System" style="text;html=1;strokeColor=none;fillColor=#fff3e0;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=18;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="50" y="470" width="1900" height="40" as="geometry" />
        </mxCell>

        <!-- Business Table -->
        <mxCell id="business-table" value="businesses&#xa;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”&#xa;PK  id                    INTEGER                 AUTO_INCREMENT&#xa;FK  user_id               UUID                    NULL&#xa;FK  package_id            INTEGER                 NULL (current)&#xa;    name                  VARCHAR(255)            NOT NULL&#xa;    description           TEXT&#xa;    is_active             BOOLEAN                 DEFAULT true&#xa;    embedding_status      VARCHAR(50)             'pending'|'queued'|'ready'|'failed'&#xa;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#e0f2f1;strokeColor=#004d40;strokeWidth=2;fontSize=10;fontFamily=Courier New;align=left;verticalAlign=top;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="50" y="540" width="450" height="180" as="geometry" />
        </mxCell>

        <!-- Packages Table -->
        <mxCell id="packages-table" value="packages&#xa;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”&#xa;PK  id                    INTEGER                 AUTO_INCREMENT&#xa;    name                  VARCHAR(255)            'Free'|'Standard'|'Premium'&#xa;    price                 DECIMAL(10,2)           0.00 | 299.00 | 999.00&#xa;    rate_limit_per_min    INTEGER                60 | 120 | NULL (unlimited)&#xa;    is_active             BOOLEAN                 DEFAULT true&#xa;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=2;fontSize=10;fontFamily=Courier New;align=left;verticalAlign=top;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="550" y="540" width="450" height="180" as="geometry" />
        </mxCell>

        <!-- Business Packages Table -->
        <mxCell id="business-packages-table" value="business_packages&#xa;(Junction Table)&#xa;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”&#xa;FK  business_id           INTEGER                 NOT NULL&#xa;FK  package_id            INTEGER                 NOT NULL&#xa;    start_date            TIMESTAMP               NOT NULL&#xa;    end_date              TIMESTAMP               NULL&#xa;    status                ENUM                    'active'|'expired'|'cancelled'&#xa;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#880e4f;strokeWidth=2;fontSize=10;fontFamily=Courier New;align=left;verticalAlign=top;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="1050" y="540" width="450" height="200" as="geometry" />
        </mxCell>

        <!-- Rate Limit Check -->
        <mxCell id="rate-limit-check" value="âš¡ Rate Limit Check&#xa;(rateLimit.middleware.js)&#xa;&#xa;1. Get user package&#xa;2. Get rate_limit_per_min&#xa;3. Check current usage&#xa;4. Block if exceeded" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#1b5e20;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="1550" y="540" width="250" height="160" as="geometry" />
        </mxCell>

        <!-- Package Relationships -->
        <mxCell id="rel-business-packages" value="N:M" style="endArrow=ERmany;startArrow=ERmany;html=1;rounded=0;exitX=1;exitY=0.5;entryX=0;entryY=0.5;strokeWidth=2;strokeColor=#d32f2f" edge="1" parent="1" source="business-table" target="business-packages-table">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="rel-packages-junction" value="" style="endArrow=ERmany;startArrow=ERone;html=1;rounded=0;exitX=0.5;exitY=1;entryX=0.5;entryY=0;strokeWidth=2;strokeColor=#d32f2f" edge="1" parent="1" source="packages-table" target="business-packages-table">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="rel-package-limit" value="Get Limit" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10;strokeColor=#1976d2;dashed=1" edge="1" parent="1" source="business-packages-table" target="rate-limit-check">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- PART 3: Payment Slip Flow -->
        <mxCell id="part3-title" value="PART 3: Payment Slip Upload â†’ Verification â†’ Approval" style="text;html=1;strokeColor=none;fillColor=#fce4ec;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=1;fontSize=18;fontStyle=1" vertex="1" parent="1">
          <mxGeometry x="50" y="800" width="1900" height="40" as="geometry" />
        </mxCell>

        <!-- User Uploads Slip -->
        <mxCell id="user-upload" value="ðŸ‘¤ User (Sponsor/Member)&#xa;Opens Payment Page" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5ff;strokeColor=#01579b;strokeWidth=2;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="50" y="870" width="200" height="80" as="geometry" />
        </mxCell>

        <!-- Payment Form -->
        <mxCell id="payment-form" value="ðŸ“ Payment Form&#xa;â€¢ Select Package&#xa;â€¢ Upload Slip Image&#xa;â€¢ Enter Amount&#xa;â€¢ Transfer Date/Time&#xa;â€¢ Note" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="300" y="870" width="250" height="140" as="geometry" />
        </mxCell>

        <!-- Upload Slip -->
        <mxCell id="upload-slip" value="ðŸ“¤ POST /api/payment-slips/upload&#xa;Multer Middleware&#xa;Save Image File" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#4a148c;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="600" y="870" width="250" height="120" as="geometry" />
        </mxCell>

        <!-- Payment Slip Controller -->
        <mxCell id="payment-controller" value="ðŸŽ¯ Payment Slip Controller&#xa;uploadPaymentSlip()&#xa;Create PaymentSlip&#xa;status = 'pending'" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e0f2f1;strokeColor=#004d40;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="900" y="870" width="250" height="140" as="geometry" />
        </mxCell>

        <!-- Payment Slips Table -->
        <mxCell id="payment-slips-table" value="payment_slips&#xa;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”&#xa;PK  id                    UUID                    NOT NULL&#xa;FK  business_package_id   INTEGER                 NULL&#xa;FK  user_id               UUID                    NULL&#xa;    slip_url              VARCHAR(255)            NOT NULL&#xa;    amount                DECIMAL(10,2)           NOT NULL&#xa;    transfer_date         DATE&#xa;    transfer_time         TIME&#xa;    status                ENUM                    'pending'|'approved'|'rejected'&#xa;    note                  TEXT&#xa;    admin_note            TEXT&#xa;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=2;fontSize=10;fontFamily=Courier New;align=left;verticalAlign=top;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="1200" y="870" width="400" height="260" as="geometry" />
        </mxCell>

        <!-- Admin Review -->
        <mxCell id="admin-review" value="ðŸ‘¨â€ðŸ’¼ Admin/Staff Review&#xa;Admin Panel â†’ Payment Slips Tab&#xa;View Slip Image&#xa;Check Details" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#1b5e20;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="50" y="1070" width="250" height="120" as="geometry" />
        </mxCell>

        <!-- Decision -->
        <mxCell id="decision" value="â“ Decision?" style="rhombus;whiteSpace=wrap;html=1;fillColor=#fff9c4;strokeColor=#f57f17;strokeWidth=2;fontSize=12" vertex="1" parent="1">
          <mxGeometry x="350" y="1070" width="150" height="100" as="geometry" />
        </mxCell>

        <!-- Approve -->
        <mxCell id="approve" value="âœ… Approve&#xa;POST /api/payment-slips/:id/approve&#xa;Update status = 'approved'" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e8f5e9;strokeColor=#1b5e20;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="550" y="1070" width="250" height="100" as="geometry" />
        </mxCell>

        <!-- Reject -->
        <mxCell id="reject" value="âŒ Reject&#xa;POST /api/payment-slips/:id/reject&#xa;Update status = 'rejected'&#xa;Add rejection_reason" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ffebee;strokeColor=#c62828;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="550" y="1220" width="250" height="120" as="geometry" />
        </mxCell>

        <!-- Upgrade User -->
        <mxCell id="upgrade-user" value="â¬†ï¸ Upgrade User Role&#xa;If user.role = 'member':&#xa;  â†’ role = 'member_pro'&#xa;  â†’ limit_per_minute = NULL (unlimited)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1f5ff;strokeColor=#01579b;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="850" y="1070" width="250" height="120" as="geometry" />
        </mxCell>

        <!-- Update Business Package -->
        <mxCell id="update-package" value="ðŸ“¦ Update Business Package&#xa;Apply Package to Business&#xa;Create BusinessPackage&#xa;status = 'active'&#xa;Set end_date (+1 month)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fce4ec;strokeColor=#880e4f;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="1150" y="1070" width="250" height="140" as="geometry" />
        </mxCell>

        <!-- Notification -->
        <mxCell id="notification" value="ðŸ“§ Send Notification&#xa;Email/In-App Notification&#xa;Approval Confirmation" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f3e5f5;strokeColor=#4a148c;strokeWidth=2;fontSize=11" vertex="1" parent="1">
          <mxGeometry x="1450" y="1070" width="200" height="100" as="geometry" />
        </mxCell>

        <!-- Arrows Part 3 -->
        <mxCell id="arrow8" value="1. Fill Form" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="user-upload" target="payment-form">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow9" value="2. Upload" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="payment-form" target="upload-slip">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow10" value="3. Save" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="upload-slip" target="payment-controller">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow11" value="4. Insert" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="payment-controller" target="payment-slips-table">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow12" value="5. Review" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="payment-slips-table" target="admin-review">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow13" value="6. Decide" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="admin-review" target="decision">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow14" value="Yes" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="decision" target="approve">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow15" value="No" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="decision" target="reject">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow16" value="7. Upgrade" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="approve" target="upgrade-user">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow17" value="8. Apply Package" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="approve" target="update-package">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <mxCell id="arrow18" value="9. Notify" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=10" edge="1" parent="1" source="approve" target="notification">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>

        <!-- Notes -->
        <mxCell id="notes" value="ðŸ“ Notes:&#xa;â€¢ Part 1: Business registration auto-assigns Free package and enqueues embedding&#xa;â€¢ Part 2: Package determines rate_limit_per_min (Free: 60, Standard: 120, Premium: unlimited)&#xa;â€¢ Part 3: Payment slip approval upgrades user role and applies package to business&#xa;â€¢ Business can have multiple packages over time (history in business_packages table)&#xa;â€¢ Auto-embedding triggers on business create/update (debounced 5 seconds)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f5f5f5;strokeColor=#666666;strokeWidth=1;fontSize=11;align=left;verticalAlign=top;spacingLeft=10" vertex="1" parent="1">
          <mxGeometry x="50" y="1400" width="1900" height="120" as="geometry" />
        </mxCell>

      </root>
    </mxGraphModel>
  </diagram>
</mxfile>

